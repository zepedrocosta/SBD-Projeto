[mysqld]

#############################################
#                 Basic Settings            #
#############################################
port                        = 3306
bind-address                = 0.0.0.0
datadir                     = /var/lib/mysql

#############################################
#             Character Set & Collation     #
#############################################
character-set-server        = utf8mb4
collation-server            = utf8mb4_unicode_ci

#############################################
#            Connection Settings            #
#############################################
max_connections             = 300
max_connect_errors          = 1000000
wait_timeout                = 28800
interactive_timeout         = 28800
connect_timeout             = 10
back_log                    = 300

#############################################
#           Memory / Buffer Settings        #
#############################################
innodb_buffer_pool_size     = 4G
innodb_buffer_pool_chunk_size = 128M
query_cache_type            = 0
query_cache_size            = 0
thread_cache_size           = 50
thread_stack                = 256K

#############################################
#               Table Settings              #
#############################################
table_open_cache            = 4000
table_definition_cache      = 2000
open_files_limit            = 65535

#############################################
#               MyISAM Settings             #
#############################################
key_buffer_size             = 256M
myisam_sort_buffer_size     = 128M
myisam_max_sort_file_size   = 2G
myisam_repair_threads       = 1

#############################################
#             InnoDB Settings (OLTP)        #
#############################################
innodb_file_per_table       = 1
innodb_log_file_size        = 512M
innodb_log_buffer_size      = 32M
innodb_flush_log_at_trx_commit = 1
innodb_lock_wait_timeout    = 120
innodb_autoinc_lock_mode    = 2

# I/O Optimization
innodb_read_io_threads      = 4
innodb_write_io_threads     = 4
innodb_io_capacity          = 1000
innodb_io_capacity_max      = 2000
innodb_purge_threads        = 2
innodb_page_cleaners        = 2

# Additional Performance Tweaks
innodb_adaptive_hash_index  = ON
innodb_doublewrite          = ON

#############################################
#           Sort / Join Buffers             #
#############################################
sort_buffer_size            = 1M
join_buffer_size            = 1M
read_buffer_size            = 512K
read_rnd_buffer_size        = 2M

#############################################
#          Temporary Table Settings         #
#############################################
tmp_table_size              = 256M
max_heap_table_size         = 256M

#############################################
#         Binary Logging & Replication      #
#############################################
skip-log-bin
sync_binlog                 = 0

#############################################
#           Logging Configuration           #
#############################################
slow_query_log              = 1
slow_query_log_file         = /var/lib/mysql/mysql-slow.log
long_query_time             = 2
general_log                 = 0

#############################################
#           Performance Schema              #
#############################################
performance_schema                              = ON
performance_schema_max_table_instances          = 12500
performance_schema_max_table_handles            = 4000

#############################################
#                SQL Mode                   #
#############################################
sql_mode = STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION

#############################################
#               Optimizer                   #
#############################################
optimizer_search_depth      = 62
optimizer_switch            = 'index_merge=on,index_merge_union=on,index_merge_sort_union=on,index_merge_intersection=on'

#############################################
#       Security & Compatibility            #
#############################################
local_infile                = 0


[mysql]
default-character-set       = utf8mb4

[client]
default-character-set       = utf8mb4
port                        = 3306

[mysqldump]
quick
quote-names
max_allowed_packet          = 1024M

[mysql_safe]
nice                        = 0
